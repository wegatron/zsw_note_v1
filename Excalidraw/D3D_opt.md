---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data
## Text Elements
1. transition all subresources, use D3D12_RESOURCE_BARRIER_ALL_SUBRESOURCES
2. create RT as Clear State
3. remove unnecessary transitions: to wrong type; read-read transitions
4. 避免高消耗的State: COMMON is for copies/present, not a general "catch all", D3D12: PS_RESOURCE | NON_PS_RESOURCE; Vulkan: VK_ACCESS_SHADER_READ_BIT
5. barrier问题
    过多barrier, 应当做barrier合并
    多余的转换, 转换后并不使用, 又回到原始状态
    前后状态相同的转换
    建议:
        大部分资源是Read-Only, 不需要跟踪
        在pass end时将barrier进行batch
    调试Tips:
        log all transitions, 使用grep+spreadsheets进行分析
        对于复杂情况，将resource state在frame /end/start时重置到一个已知的状态
    进一步优化:
        使用两段式, split barrier(D3D12), vkEvent
6. Designing for Multithreading
    know your workload and schedule appropriately
    Build a high-level graph of your frame
7. 异步计算(Async compute)
    需要仔细考虑设计, 如果异步计算造成资源竞争, 反而可能会性能更差.
    如果不对调度进行限定, 可能会导致资源竞争, 从而性能更差 ^anwWtlEs

1. If no GPU unit has a high throughput (compared to its SOL), then we strive to improve the achieved throughput of at least one unit.
2. If some GPU unit has a high throughput (compared to its SOL), then we figure out how to remove work from that unit. ^m5SEEHm7

对比具体的性能数据: shading pixel, vram read/write ... ^mn7z21Af

## Embedded Files
193bf21419340a70be6d2c09ad0963bfc8ae8e68: [[Pasted Image 20241210165246_376.png]]

b5984fef5eaa79c47ad0adc336c653aa10e94fc6: [[Pasted Image 20241210174104_260.png]]

61c8a713cf08b75aa6a542f27eead6390998dbcb: [[Pasted Image 20241210174131_704.png]]

ccd7e58ae51ed0794cd20f98201198ca31f1b67e: [[Pasted Image 20241210174150_769.png]]

1bdd8af2b32c9418835f1fee73a8f8b4706187b4: [[Pasted Image 20241210175035_687.png]]

c7553e38c3a1559cc7c7bb32ad0344bbca7e261b: [[Pasted Image 20241211173350_486.png]]

%%
## Drawing
```compressed-json
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
```
%%